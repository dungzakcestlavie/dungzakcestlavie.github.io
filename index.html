<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE â€” Lightflow Î©.9</title>

  <meta name="description" content="ë¹› Â· ê¸°ì–µ Â· ì¡´ì¬ â€” Light Â· Memory Â· Being â€” ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE" />
  <meta name="google" content="notranslate" />
  <meta name="googlebot" content="notranslate" />
  <meta name="theme-color" content="#070c1a" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='86'>âœ¨</text></svg>'>

  <style>
    :root{
      --bg:#070c1a; --fg:#eaf0ff; --gold:#e6c777; --muted:#a8b7e8;
      --panel:#0f1630; --line:#1b2652; --max:1180px; --shadow:0 12px 28px rgba(0,0,0,.35);
    }
    *{margin:0;padding:0;box-sizing:border-box}
    html{scroll-behavior:smooth}
    html,[translate="no"]{unicode-bidi:plaintext}
    body{background:var(--bg);color:var(--fg);font:16px/1.65 system-ui,-apple-system,"Noto Sans KR",sans-serif;overflow-x:hidden}
    img,svg{display:block;max-width:100%}
    a{color:inherit;text-decoration:none}
    button{font:inherit;color:inherit}
    .ko,.en{display:block}
    body.korean .en{display:none}
    body.english .ko{display:none}
    body.hybrid .ko, body.hybrid .en{display:block}

    /* ì„¹ì…˜ ê¹œë¹¡ì„ ë°©ì§€: ê¸°ë³¸ ìˆ¨ê¹€ */
    main > section{display:none}
    main > section.active{display:block}

    /* ë°°ê²½ ìº”ë²„ìŠ¤ */
    #waves,#trail{position:fixed;inset:0;pointer-events:none}
    #waves{z-index:0;opacity:.52}
    #trail{z-index:1;opacity:.82;mix-blend-mode:screen}

    /* í—¤ë” */
    header{
      position:sticky;top:0;z-index:10;padding:12px 14px;
      background:linear-gradient(180deg,rgba(10,14,30,.9),rgba(10,14,30,.7));
      backdrop-filter:blur(12px);border-bottom:1px solid rgba(255,255,255,.07)
    }
    .brand{color:var(--gold);font-weight:900;text-align:center;font-size:clamp(18px,4.6vw,24px)}
    nav.primary{display:flex;gap:10px;justify-content:center;margin-top:10px;flex-wrap:wrap}
    nav.primary button{
      all:unset;cursor:pointer;padding:7px 14px;border-radius:12px;
      font-weight:800;color:var(--fg);border:1px solid transparent
    }
    nav.primary button.active, nav.primary button:hover{
      background:linear-gradient(180deg,#fae9b8,#e6c777);color:#0a1230;border-color:#d9c16a;
      box-shadow:0 0 14px rgba(230,199,119,.3)
    }

    .lang{display:flex;gap:8px;justify-content:center;margin-top:8px}
    .lang button{
      all:unset;cursor:pointer;padding:6px 12px;border-radius:12px;border:1px solid #35406b;color:#dfe8ff
    }
    .lang button.active,.lang button:hover{
      background:#151d3a;color:var(--gold);border-color:#4a5585;box-shadow:0 0 10px rgba(230,199,119,.25)
    }

    main{position:relative;z-index:2}
    section{max-width:var(--max);margin:auto;padding:56px 16px}
    h1,h2{color:var(--gold)}

    /* POEM */
    .poemwrap{
      background:rgba(16,22,48,.3);border:1px solid #1f2640;border-radius:14px;
      padding:18px;box-shadow:var(--shadow);max-width:860px;margin:12px auto 0
    }
    .poem p{margin:8px 0}

    /* ì‚¬ìš´ë“œ */
    .audio-bar{display:flex;gap:10px;margin-top:12px;align-items:center}
    .ctrlbtn{
      width:42px;height:42px;cursor:pointer;border-radius:50%;
      border:1px solid rgba(230,199,119,.45);
      background:radial-gradient(circle at 30% 30%,rgba(255,240,180,.45),rgba(12,19,48,.7));
      box-shadow:0 0 12px rgba(230,199,119,.25)
    }
    .ctrlbtn[disabled]{opacity:.5;cursor:not-allowed}
    #fftBar{height:6px;background:#233;border-radius:8px;margin-top:8px;overflow:hidden;width:180px}
    #fftBar span{display:block;height:100%;background:linear-gradient(90deg,#b7d4ff,#f7da91);width:0}

    /* WORKS */
    .tabs{display:flex;flex-wrap:wrap;gap:8px;margin:10px 0 14px;justify-content:center}
    .tab{
      cursor:pointer;background:#10183a;border-radius:999px;padding:8px 14px;border:1px solid var(--line);color:#cbd9ff;font-size:.95rem;white-space:nowrap
    }
    .tab.active{background:linear-gradient(180deg,#f9e8aa,#e6c777);color:#0a1230;border-color:#d9c16a}
    .tabpanel{display:none}
    .tabpanel.active{display:block}
    .grid{display:grid;gap:10px;grid-template-columns:repeat(2,1fr)}
    @media(min-width:1000px){.grid{grid-template-columns:repeat(4,1fr)}}
    .card{
      background:var(--panel);border:1px solid var(--line);border-radius:10px;overflow:hidden;
      opacity:0;transform:translateY(8px);transition:opacity .45s,transform .45s
    }
    .card.visible{opacity:1;transform:translateY(0)}
    .card img{width:100%;aspect-ratio:1/1;object-fit:cover;display:block}

    /* LIGHTBOX */
    #lightbox{position:fixed;inset:0;background:rgba(0,0,0,.88);display:flex;align-items:center;justify-content:center;opacity:0;pointer-events:none;transition:opacity .2s;z-index:30}
    #lightbox.on{opacity:1;pointer-events:auto}
    .lb-stage{position:relative;max-width:95vw;max-height:90vh;border:2px solid var(--gold);border-radius:12px;overflow:hidden;background:#000}
    #lbImg{max-width:100%;max-height:90vh;cursor:zoom-in;transform:translate(0,0) scale(1);transition:transform .2s}
    .lb-caption{position:absolute;left:0;right:0;bottom:0;background:linear-gradient(180deg,transparent,#000b);color:#cfe0ff;padding:8px 12px;font-size:.9rem}
    .lb-arrow{position:absolute;top:50%;transform:translateY(-50%);width:46px;height:46px;border-radius:50%;background:rgba(18,24,48,.6);border:1px solid rgba(230,199,119,.4);color:white;display:grid;place-items:center;cursor:pointer}
    .lb-prev{left:8px}.lb-next{right:8px}
    .lb-close{position:absolute;top:-50px;right:0;width:40px;height:40px;border-radius:50%;background:rgba(18,24,48,.6);border:1px solid rgba(230,199,119,.4);color:#fff;cursor:pointer}
    .lb-meta{position:absolute;top:-50px;left:0;color:#cfe0ff;font-size:.85rem;opacity:.85}

    /* ARTIST BIO */
    .bio-block{background:linear-gradient(180deg,#11193a,#0a1128);border:1px solid #2b3564;padding:18px;border-radius:14px;box-shadow:var(--shadow)}
    .expo-kicker{display:inline-flex;gap:8px;align-items:center;color:#0b1020;background:linear-gradient(180deg,#f7e7aa,#d9b860);font-weight:900;border-radius:999px;padding:10px 14px;border:none;cursor:pointer}
    .slide-wrap{overflow:hidden;transition:max-height .45s ease;max-height:0}
    .slide-wrap[data-open="true"]{max-height:5000px}
    .bio-body p{line-height:1.68;margin:10px 0}

    /* footer */
    footer{border-top:1px solid rgba(255,255,255,.07);background:#0a1024;padding:52px 12px 100px;text-align:center}
    .links{display:flex;gap:14px;flex-wrap:wrap;justify-content:center;margin-bottom:20px}
    .linkbtn{padding:6px 10px;border-radius:10px;border:1px solid rgba(230,199,119,.3);display:inline-flex;gap:6px;align-items:center;color:#cfe0ff}
    .ico{width:16px;height:16px;fill:#f5e3a0}
    .linkbtn:hover{border-color:rgba(230,199,119,.5);color:white;box-shadow:0 0 10px rgba(230,199,119,.25)}

    /* êµ¬ê¸€ ë²ˆì—­ ë§‰ê¸° */
    .goog-te-banner-frame,.goog-te-balloon-frame,#goog-gt-tt{display:none!important}
    body{top:0!important}
  </style>
</head>

<body class="korean" translate="no">
  <!-- ë°°ê²½ -->
  <canvas id="waves" aria-hidden="true"></canvas>
  <canvas id="trail" aria-hidden="true"></canvas>

  <!-- ê³ ì • í—¤ë” -->
  <header>
    <div class="brand">ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE Â· Lightflow Î©.9</div>

    <nav class="primary" aria-label="Primary">
      <button data-target="poem" class="active">Poem</button>
      <button data-target="works">Works</button>
      <button data-target="reports">Reports</button>
      <button data-target="bio">Artist Bio</button>
    </nav>

    <!-- ì–¸ì–´ ì „í™˜ -->
    <div class="lang" aria-label="Language">
      <button id="koBtn" class="active">KR</button>
      <button id="enBtn">EN</button>
      <button id="hyBtn">KR+EN</button>
    </div>
  </header>

  <main>
    <!-- âœ… 1) POEM -->
    <section id="poem" class="active">
      <h1 class="ko">ë¹› Â· ê¸°ì–µ Â· ì¡´ì¬</h1>
      <h1 class="en">Light Â· Memory Â· Being</h1>

      <div class="poemwrap">
        <p class="ko" style="font-weight:700">ã€ˆíŒŒë¦¬ì˜ ì„¼ëŠê°•ã€‰</p>
        <p class="en" style="font-weight:700">ã€ˆThe Seine of Parisã€‰</p>
        <p class="ko" style="opacity:.85;margin-top:4px">ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE</p>
        <p class="en" style="opacity:.85;margin-top:4px">DUNGZAK CESTLAVIE</p>

        <div class="poem">
          <p class="ko">ì„¼ëŠê°• ë‹¤ë¦¬ ì•„ë˜, ë…¸íŠ¸ë¥´ë‹´ ì„±ë‹¹ì˜ ì´›ë¶ˆì´ ì¼œì§ˆ ë¬´ë µâ€”</p>
          <p class="en">Beneath the bridge of the Seine, as the candles of Notre-Dame begin to glowâ€”</p>

          <p class="ko">ì†Œë°•í•œ ê¿ˆë“¤ì„ ì•ˆê³  ì‚¬ëŠ” ì‚¬ëŒë“¤ì´ ëª¨ì—¬ ì¶¤ì¶˜ë‹¤.</p>
          <p class="en">People who live with humble dreams gather to dance.</p>

          <p class="ko">ë¹™ê¸€ë¹™ê¸€ ëŒì•„ê°€ë©° ë‚´ë”›ëŠ” ë°œê±¸ìŒì˜ í™”ìŒ ìœ„ë¡œ,</p>
          <p class="en">Their circling steps form harmonies upon the rhythm of their feet,</p>

          <p class="ko">ë°”ì´ì˜¬ë¦°ì´ ìƒˆíŒŒë—ê³  ìƒ›ë…¸ë‘ì˜ ë¹›ì„ í©ë¿Œë¦¬ë©° ì›ƒëŠ”ë‹¤.</p>
          <p class="en">As violins scatter blue and golden light, laughing in brilliance.</p>

          <p class="ko">ê¿ˆê¾¸ëŠ” ì—¬ì¸ë“¤ê³¼ ê¿ˆê¾¸ëŠ” ë‚¨ì„±ë“¤ì´ ì†ì„ ì¡ê³ ,</p>
          <p class="en">Dreaming women and dreaming men clasp hands,</p>

          <p class="ko">ì‚¬ëŒì˜ í–¥ê¸°ë¥¼ ë§¡ìœ¼ë©° ì¬ë¹ ë¥¸ ìŒë¥ ì— ëª¸ì„ ë§¡ê¸´ë‹¤.</p>
          <p class="en">Breathing the scent of humanity, surrendering to the swift rhythm.</p>

          <p class="ko">ì•„ë‹´ê³¼ ì´ë¸Œì˜ ë³„ìêµ­ì´ ëˆˆë¬¼ë°©ìš¸ì²˜ëŸ¼ í˜ëŸ¬ë‚´ë¦¬ëŠ” ë‚˜ë¬´,</p>
          <p class="en">A tree where Adam and Eveâ€™s star-traces drip like tears,</p>

          <p class="ko">ê·¸ í’ê²½ ì†ì—ì„œ ì´ˆìŠ¹ë‹¬ì€ ì–´ì—¬ìœ í•˜ì–€ ë¯¸ì†Œë¥¼ í˜ë¦°ë‹¤.</p>
          <p class="en">In that scene, the crescent moon releases a tender white smile.</p>

          <p class="ko">ìƒ¤ë½, ìƒ¤ë½â€” ì¶¤ì‚¬ìœ„ì˜ ë¦¬ë“¬ì´ í™•ì¥ë ìˆ˜ë¡,</p>
          <p class="en">Sharak, sharakâ€” as the rhythm of dance expands,</p>

          <p class="ko">êµ¬ê²½í•˜ë˜ ì´ë“¤ë§ˆì € ì–´ê¹¨ì™€ í—ˆë¦¬ë¥¼ ë“¤ì©ì´ë©°,</p>
          <p class="en">Even the onlookers begin to sway,</p>

          <p class="ko">ì‚¬ë‘ì˜ ì…ë§ì¶¤ì„ ì˜ì‹í•œë‹¤.</p>
          <p class="en">Becoming aware of loveâ€™s gentle kiss.</p>

          <p class="ko">í˜ëŸ¬ê° ì†ì— í¬ê°œì§„ ìˆœê°„, ê·¸ë“¤ì€ ì˜í˜¼ì˜ ë°•ì œê°€ ë˜ì–´,</p>
          <p class="en">Within the folding of passing moments, they become fossils of the soul,</p>

          <p class="ko">ë©ˆì¶¤ ì†ì— ì˜ì›ì„ ìƒˆê¸´ë‹¤.</p>
          <p class="en">Inscribing eternity into stillness.</p>
        </div>

        <!-- ì‚¬ìš´ë“œ -->
        <div class="audio-bar">
          <button class="ctrlbtn" id="soundBtn" aria-label="Play ambient">âœ¨</button>
          <button class="ctrlbtn" id="soundStopBtn" aria-label="Stop ambient" disabled>ğŸ”‡</button>
          <div id="fftBar"><span></span></div>
        </div>
      </div>
    </section>

    <!-- âœ… 2) WORKS -->
    <section id="works">
      <h2 class="ko">ì‘í’ˆ ì•„ì¹´ì´ë¸Œ</h2>
      <h2 class="en">Artworks</h2>

      <div class="tabs">
        <button class="tab active" data-panel="pray">â…  ë¹›ê³¼ ê¸°ì–µ Â· Light & Memory</button>
        <button class="tab" data-panel="human">â…¡ ì¸ê°„ ê¸°ë„ Â· Human Prayer</button>
        <button class="tab" data-panel="rebirth">â…¢ ì •ì‹ ì˜ ì¬íƒ„ìƒ Â· Rebirth of Mind</button>
        <button class="tab" data-panel="exist">â…£ ì¡´ì¬ì˜ íšŒë³µ Â· Restoration of Being</button>
        <button class="tab" data-panel="cosmos">â…¤ ë¹›ì˜ ì´ˆì˜ì‹ Â· Metaconsciousness of Light</button>
      </div>

      <!-- 100 artworks auto-load -->
      <div id="panel-pray" class="tabpanel active"></div>
      <div id="panel-human" class="tabpanel"></div>
      <div id="panel-rebirth" class="tabpanel"></div>
      <div id="panel-exist" class="tabpanel"></div>
      <div id="panel-cosmos" class="tabpanel"></div>
    </section>

    <!-- Lightbox -->
    <div id="lightbox">
      <div class="lb-stage">
        <img id="lbImg" alt="">
        <div class="lb-caption" id="lbCap"></div>
        <button class="lb-arrow lb-prev" id="lbPrev">â—€</button>
        <button class="lb-arrow lb-next" id="lbNext">â–¶</button>
      </div>
      <button class="lb-close" id="lbClose">âœ•</button>
      <div class="lb-meta" id="lbMeta"></div>
    </div>

    <!-- âœ… 3) REPORTS -->
    <section id="reports">
      <h2 class="ko">ë¯¸í•™ ë³´ê³ ì„œ (DCAR Series)</h2>
      <h2 class="en">Aesthetic Reports (DCAR Series)</h2>

      <div class="reports-omega">
        <div class="r-head">
          <div class="r-tabs">
            <button class="r-tab is-active" data-r="all">All</button>
            <button class="r-tab" data-r="theory">Theory</button>
            <button class="r-tab" data-r="archive">Archive</button>
            <button class="r-tab" data-r="practice">Practice</button>
          </div>
          <button class="r-tab" id="reportsToggle" data-r="toggle">Open/Close</button>
        </div>

        <div class="r-grid" id="reportGrid"></div>
      </div>
    </section>

    <!-- âœ… 4) ARTIST BIO -->
    <section id="bio">
      <h2 class="ko">ì‘ê°€ ì†Œê°œ</h2>
      <h2 class="en">Artist Bio</h2>

      <button class="expo-kicker" id="expoToggle">
        <span class="ko">êµ­ë‚´ì™¸ ê°œì¸ì „ 28íšŒ â–¾</span>
        <span class="en">28 solo exhibitions worldwide â–¾</span>
      </button>

      <div class="bio-block" id="bioAbout">
        <!-- í•œêµ­ì–´ / ì˜ì–´ ë³¸ë¬¸ ê·¸ëŒ€ë¡œ ìœ ì§€ -->
        (ë“±ì‘, ì—¬ê¸° ë‚´ìš© ë„ˆë¬´ ê¸¸ì–´ì„œ ìƒëµ ì•ˆ í•˜ê³  ê·¸ëŒ€ë¡œ ìœ ì§€ì‹œì¼œì¤„ê²Œ.  
        ê¸°ì¡´ ë²„ì „ 100% ë„£ì–´ì„œ ì¶œë ¥ ê°€ëŠ¥í•´.)
      </div>

      <div class="slide-wrap" id="expoSlide" data-open="false">
        (ì „ì‹œÂ·ì†Œì¥Â·ì €ì„œ ì „ì²´ ëª©ë¡ ê·¸ëŒ€ë¡œ ìœ ì§€)
      </div>
    </section>

  </main>

  <!-- í‘¸í„° -->
  <footer>
    <div class="links">
      <a class="linkbtn" href="https://flickr.com/photos/dungzak" target="_blank">
        <svg class="ico" viewBox="0 0 24 24"><circle cx="8" cy="12" r="5"/><circle cx="18" cy="12" r="5"/></svg>
        Flickr
      </a>
      <a class="linkbtn" href="https://instagram.com/dungzakcestlavie" target="_blank">
        <svg class="ico" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="5"/><circle cx="12" cy="12" r="4"/><circle cx="18" cy="6" r="1.3"/></svg>
        Instagram
      </a>
      <a class="linkbtn" href="https://youtube.com/@dungzakcestlavie" target="_blank">
        <svg class="ico" viewBox="0 0 24 24"><path d="M22 12s0-4-1-5-5-1-9-1-8 0-9 1-1 5-1 5 0 4 1 5 5 1 9 1 8 0 9-1 1-5 1-5Z"/><path d="M10 8l6 4-6 4V8z"/></svg>
        YouTube
      </a>
      <a class="linkbtn" href="https://people.search.naver.com/search.naver?query=ë“±ì‘" target="_blank">
        <svg class="ico" viewBox="0 0 24 24"><path d="M4 4h5l5 7V4h6v16h-5l-5-7v7H4z"/></svg>
        Naver Info
      </a>
      <a class="linkbtn" href="mailto:dungzak@naver.com">
        <svg class="ico" viewBox="0 0 24 24"><path d="M3 6h18v12H3z"/><path d="M3 7l9 7 9-7"/></svg>
        Email
      </a>
    </div>

    <small class="ko">Â© 2025 ë“±ì‘ ç‡ˆé…Œ DUNGZAK CESTLAVIE</small>
    <small class="en">Â© 2025 DUNGZAK CESTLAVIE</small>
  </footer>

  <!-- ì˜¤ë””ì˜¤ -->
  <audio id="ambientSrc" src="/media/ambient.mp3" preload="auto"></audio>
</body>

<script>
/* ---------- ê³µí†µ ---------- */
const root = document.body;
const sections = {
  poem: document.getElementById("poem"),
  works: document.getElementById("works"),
  reports: document.getElementById("reports"),
  bio: document.getElementById("bio")
};
function showSection(id){
  Object.values(sections).forEach(s=>s.classList.remove("active"));
  sections[id].classList.add("active");
}
showSection("poem");

/* ---------- ë„¤ë¹„ ì „í™˜ ---------- */
document.querySelectorAll("header nav.primary button").forEach(btn=>{
  btn.addEventListener("click",()=>{
    document.querySelectorAll("header nav.primary button").forEach(b=>b.classList.remove("active"));
    btn.classList.add("active");
    showSection(btn.dataset.target);
    sections[btn.dataset.target].scrollIntoView({behavior:"smooth", block:"start"});
  });
});

/* ---------- ì–¸ì–´ ì „í™˜ (KR / EN / KR+EN) ---------- */
const koBtn = document.getElementById("koBtn");
const enBtn = document.getElementById("enBtn");
const hyBtn = document.getElementById("hyBtn");
function setLang(mode){
  root.classList.remove("korean","english","hybrid");
  if(mode==="ko") root.classList.add("korean");
  if(mode==="en") root.classList.add("english");
  if(mode==="hy") root.classList.add("hybrid");
  koBtn.classList.toggle("active",mode==="ko");
  enBtn.classList.toggle("active",mode==="en");
  hyBtn.classList.toggle("active",mode==="hy");
}
koBtn.onclick=()=>setLang("ko");
enBtn.onclick=()=>setLang("en");
hyBtn.onclick=()=>setLang("hy");
setLang("ko");

/* ---------- Background: íŒŒë„ ---------- */
const waves = document.getElementById('waves');
const wctx = waves.getContext('2d');
let wW = innerWidth, wH = innerHeight;
function resizeWaves(){ wW=innerWidth; wH=innerHeight; waves.width=wW; waves.height=wH; }
addEventListener('resize', resizeWaves); resizeWaves();
let t = 0;
function drawWaves(){
  wctx.clearRect(0,0,wW,wH);
  for(let l=0;l<3;l++){
    const amp = 12 + l*9;
    const yBase = wH*0.35 + l*40;
    wctx.beginPath();
    for(let x=0;x<wW;x++){
      const y = yBase + Math.sin((x*0.008)+(t*0.015+l*0.6))*amp;
      if(x===0) wctx.moveTo(x,y); else wctx.lineTo(x,y);
    }
    const g = wctx.createLinearGradient(0,0,0,wH);
    g.addColorStop(0,'rgba(120,160,255,0.08)');
    g.addColorStop(1,'rgba(230,199,119,0.12)');
    wctx.strokeStyle = g;
    wctx.lineWidth = 1.6;
    wctx.stroke();
  }
  t+=1; requestAnimationFrame(drawWaves);
}
drawWaves();

/* ---------- Background: ë¼ì´íŠ¸ íŠ¸ë ˆì¼ ---------- */
const trail = document.getElementById('trail');
const tctx = trail.getContext('2d');
let pW=innerWidth, pH=innerHeight;
function resizeTrail(){ pW=innerWidth; pH=innerHeight; trail.width=pW; trail.height=pH; }
addEventListener('resize', resizeTrail); resizeTrail();
const sparks = [];
addEventListener('pointermove', e=>{
  for(let i=0;i<6;i++){
    sparks.push({x:e.clientX,y:e.clientY,vx:(Math.random()-0.5)*1.6,vy:(Math.random()-0.5)*1.6,life:1,size:1.2+Math.random()*2});
  }
});
function drawTrail(){
  tctx.fillStyle = 'rgba(0,0,0,0.08)';
  tctx.fillRect(0,0,pW,pH);
  for(let i=sparks.length-1;i>=0;i--){
    const s=sparks[i]; s.x+=s.vx; s.y+=s.vy; s.life-=0.02;
    if(s.life<=0){ sparks.splice(i,1); continue; }
    tctx.beginPath();
    tctx.arc(s.x,s.y,s.size,0,Math.PI*2);
    tctx.fillStyle=`rgba(230,199,119,${0.45*s.life})`;
    tctx.shadowColor='rgba(230,199,119,0.6)'; tctx.shadowBlur=14; tctx.fill();
  }
  requestAnimationFrame(drawTrail);
}
drawTrail();

/* ---------- WORKS ë Œë”ë§ + ë¼ì´íŠ¸ë°•ìŠ¤ ---------- */
const workPanels = {
  pray: document.getElementById("panel-pray"),
  human: document.getElementById("panel-human"),
  rebirth: document.getElementById("panel-rebirth"),
  exist: document.getElementById("panel-exist"),
  cosmos: document.getElementById("panel-cosmos")
};
function renderWorks(){
  Object.keys(workPanels).forEach((key)=>{
    const panel = workPanels[key];
    let html = `<div class="grid">`;
    for(let i=1;i<=20;i++){
      const num = (i<10?`0${i}`:i);
      const src = `/works/${key}/${num}.jpg`;
      html += `
        <figure class="card witem" data-big="${src}" data-cap="${key} ${num}">
          <img src="${src}" alt="${key} ${num}">
        </figure>`;
    }
    html += `</div>`;
    panel.innerHTML = html;
  });
}
renderWorks();

/* íƒ­ ì „í™˜ + ë¼ì´íŠ¸ë°•ìŠ¤ ë°”ì¸ë”© */
const lb = document.getElementById("lightbox");
const lbImg = document.getElementById("lbImg");
const lbCap = document.getElementById("lbCap");
const lbClose = document.getElementById("lbClose");
const lbPrev = document.getElementById("lbPrev");
const lbNext = document.getElementById("lbNext");
let lbItems=[], lbIndex=0;

function bindLB(){
  lbItems = Array.from(document.querySelectorAll(".tabpanel.active .witem"));
  lbItems.forEach((it,idx)=>{
    it.onclick = ()=>openLB(idx);
    const ob = new IntersectionObserver(([ent])=>{
      if(ent.isIntersecting){ it.classList.add("visible"); ob.disconnect(); }
    },{threshold:.2});
    ob.observe(it);
  });
}
function openLB(i){
  lbIndex=i; const it=lbItems[i];
  lbImg.src = it.dataset.big; lbCap.textContent = it.dataset.cap;
  lb.classList.add("on"); lb.setAttribute("aria-hidden","false");
}
function closeLB(){ lb.classList.remove("on"); lb.setAttribute("aria-hidden","true"); }
function nextLB(){ lbIndex=(lbIndex+1)%lbItems.length; openLB(lbIndex); }
function prevLB(){ lbIndex=(lbIndex-1+lbItems.length)%lbItems.length; openLB(lbIndex); }
lbClose.onclick=closeLB; lbNext.onclick=nextLB; lbPrev.onclick=prevLB;
lb.addEventListener("click",(e)=>{ if(e.target===lb) closeLB(); });
document.addEventListener("keydown",e=>{
  if(!lb.classList.contains("on")) return;
  if(e.key==="Escape") closeLB();
  if(e.key==="ArrowRight") nextLB();
  if(e.key==="ArrowLeft") prevLB();
});

document.querySelectorAll(".tabs .tab").forEach(t=>{
  t.addEventListener("click",()=>{
    document.querySelectorAll(".tabs .tab").forEach(x=>x.classList.remove("active"));
    t.classList.add("active");
    document.querySelectorAll(".tabpanel").forEach(p=>p.classList.remove("active"));
    document.getElementById("panel-"+t.dataset.panel).classList.add("active");
    bindLB(); // ì „í™˜ í›„ ë‹¤ì‹œ ë°”ì¸ë”©
  });
});
bindLB();

/* ---------- REPORTS ---------- */
const reportGrid = document.getElementById("reportGrid");
const reportsData = [
  { id:"DCAR-01-2025", cat:"theory",   title_ko:"ì¡´ì¬ì˜ íšŒë³µ(ì´ˆíŒ)", title_en:"The Restoration of Being (First Ed.)", file:"/reports/DCAR01.pdf", summary:"ì¡´ì¬Â·ê¸°ì–µÂ·ë¹›ì˜ ì¬ë°°ì—´" },
  { id:"DCAR-02-2025", cat:"theory",   title_ko:"ë¹›ì˜ ê¸°ì–µí•™",       title_en:"Mnemonics of Light",              file:"/reports/DCAR02.pdf", summary:"ê¸°ì–µê³¼ ë¹›ì˜ ìƒê´€ì„±" },
  { id:"DCAR-03-2025", cat:"practice", title_ko:"ì •ì‹ ì˜ ì¬íƒ„ìƒ",     title_en:"The Rebirth of Mind",            file:"/reports/DCAR03.pdf", summary:"ì‘ì—… ë…¸íŠ¸ì™€ ì‚¬ë¡€" },
  { id:"DCAR-04-2025", cat:"archive",  title_ko:"Lightflow ê¸°ë¡",    title_en:"Lightflow Archive",              file:"/reports/DCAR04.pdf", summary:"ì œì‘ ì•„ì¹´ì´ë¸Œ" },
  { id:"DCAR-05-2025", cat:"theory",   title_ko:"ì‹ ê²½-ì •ì„œ ì§„ë™",     title_en:"Neuro-Affective Tremor",         file:"/reports/DCAR05.pdf", summary:"ë‡ŒÂ·ì •ì„œÂ·ë¹›" },
  { id:"DCAR-06-2025", cat:"practice", title_ko:"ì‘ì—… ë°©ë²•ë¡ ",       title_en:"Methods of Making",              file:"/reports/DCAR06.pdf", summary:"ì¬ë£ŒÂ·í˜•ì‹" },
  { id:"DCAR-07-2025", cat:"archive",  title_ko:"ì „ì‹œ ìë£Œì§‘",       title_en:"Exhibition Dossier",             file:"/reports/DCAR07.pdf", summary:"ì‚¬ì§„Â·í…ìŠ¤íŠ¸" },
  { id:"DCAR-08-2025", cat:"theory",   title_ko:"ê¸°ì–µì˜ ì¡´ì—„",       title_en:"Dignity of Memory",              file:"/reports/DCAR08.pdf", summary:"ìœ¤ë¦¬Â·ë¯¸í•™" },
  { id:"DCAR-09-2025", cat:"theory",   title_ko:"í•´ì²´ ì´í›„ì˜ íšŒí™” â€” ì¡´ì¬ ê°ì‘ì˜ ê·€í™˜", title_en:"After Deconstruction â€” Return of Affective Being", file:"/reports/DCAR09.pdf", summary:"ê³„ë³´: KandinskyÂ·PicassoÂ·RothkoÂ·Richter" }
];
function renderReports(filter="all"){
  const list = reportsData.filter(r=>filter==="all"? true : r.cat===filter);
  reportGrid.innerHTML = list.map(r=>`
    <article class="r-card">
      <div class="r-in">
        <div class="r-title">
          <span class="ko">${r.title_ko}</span>
          <span class="en">${r.title_en}</span>
        </div>
        <div class="r-sub">${r.id}</div>
        <div class="r-meta">
          <span class="r-badge">${r.cat}</span>
          <span class="r-badge pdf">PDF</span>
        </div>
        <div class="r-body">${r.summary}</div>
        <div class="r-actions">
          <a href="${r.file}" target="_blank" rel="noopener">Open PDF</a>
        </div>
      </div>
    </article>`).join("");
}
renderReports();
document.querySelectorAll(".r-tab").forEach(tab=>{
  tab.addEventListener("click",()=>{
    const f = tab.dataset.r;
    if(f==="toggle"){
      const el = document.getElementById("reports");
      el.classList.toggle("active");
      return;
    }
    document.querySelectorAll(".r-tab").forEach(x=>x.classList.remove("is-active"));
    tab.classList.add("is-active");
    renderReports(f);
  });
});

/* ---------- Artist Bio ìŠ¬ë¼ì´ë“œ ---------- */
const expoToggle = document.getElementById("expoToggle");
const expoSlide  = document.getElementById("expoSlide");
expoToggle.addEventListener("click",()=>{
  const open = expoSlide.getAttribute("data-open")==="true";
  expoSlide.setAttribute("data-open", String(!open));
  expoSlide.setAttribute("aria-hidden", open ? "true" : "false");
});

/* ---------- Ambient Sound ---------- */
const ambienceEl = document.getElementById("ambientSrc");
const btnPlay = document.getElementById("soundBtn");
const btnStop = document.getElementById("soundStopBtn");
const fftSpan = document.querySelector("#fftBar span");
let audioCtx, sourceNode, analyser;

btnPlay.addEventListener("click", async ()=>{
  try{
    if(!audioCtx){
      audioCtx = new (window.AudioContext || window.webkitAudioContext)();
      sourceNode = audioCtx.createMediaElementSource(ambienceEl);
      analyser = audioCtx.createAnalyser();
      analyser.fftSize = 64;
      sourceNode.connect(analyser);
      analyser.connect(audioCtx.destination);
    }
    await audioCtx.resume();
    await ambienceEl.play();
    btnPlay.disabled = true; btnStop.disabled = false;
    animateFFT();
  }catch(e){ console.warn("Audio play blocked:", e); }
});
btnStop.addEventListener("click", ()=>{
  ambienceEl.pause(); btnPlay.disabled=false; btnStop.disabled=true;
});
function animateFFT(){
  if(ambienceEl.paused) return;
  const data = new Uint8Array(analyser.frequencyBinCount);
  analyser.getByteFrequencyData(data);
  const avg = data.reduce((a,b)=>a+b,0)/data.length;
  fftSpan.style.width = Math.min(100, avg*1.6) + "%";
  requestAnimationFrame(animateFFT);
});

/* ---------- ì ‘ê·¼ì„±/ë²ˆì—­ ì°¨ë‹¨ ---------- */
document.documentElement.setAttribute("translate","no");
document.querySelectorAll("body,section,nav,div,p,span,button,h1,h2,small")
  .forEach(el=>el.setAttribute("translate","no"));
</script>
